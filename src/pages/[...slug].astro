---
import fetchApi from "@/lib/strapi";
import type {Page} from "@/interfaces/page";
import BlockManager from "@/components/BlockManager.astro";
import MainLayout from "@/layouts/MainLayout.astro";

export async function getStaticPaths() {

	const pages = await fetchApi<Page[]>({
		endpoint: 'pages',
		wrappedByKey: 'data',
	})	

	return pages.map(page => {
		return {
			params: { slug: page.attributes.slug ?? undefined },
			props: page,
		}
	})
}

const page = Astro.props;
---

<MainLayout title={page.attributes.title}>
	<BlockManager components={page.attributes.components} />
</MainLayout>
