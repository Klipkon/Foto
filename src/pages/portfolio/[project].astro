---
import type { ArticleData } from "@/interfaces/article.interface";
import ArticleLayout from "@/layouts/ArticleLayout.astro";
import "@/styles/globals.css";
import qs from "qs";
import fetchApi from "../../lib/strapi";
import { titleToSlug } from "../../lib/utils";

export async function getStaticPaths() {
  const projects = await fetchApi<ArticleData[]>({
    endpoint: "projects",
    wrappedByKey: "data",
    query: qs.stringify({
      populate: {
        seo: true,
        image: true,
        category: true,
      },
    }),
  });

  return projects.map((project) => {
    return {
      params: {
        project: titleToSlug(project.attributes.title),
      },
      props: project,
    };
  });
}

const project = Astro.props;
---

<ArticleLayout article={project} />
