---
import "@/styles/globals.css";
import fetchApi from "@/lib/strapi";
import ArticleLayout from "@/layouts/ArticleLayout.astro";
import type { ArticleData } from "@/interfaces/article.interface";
import Title from "@/components/Title.astro";
import Prose from "@/components/Prose.astro";
import { marked } from "marked";
import DOMPurify from "isomorphic-dompurify";
import { titleToSlug } from "@/lib/utils";
import { Image } from "astro:assets";

export async function getStaticPaths() {
  const articles = await fetchApi<ArticleData[]>({
    endpoint: "articles",
    wrappedByKey: "data",
    query: "populate=*",
  });

  return articles.map((article) => {
    return {
      params: {
        article: titleToSlug(article.attributes.title),
      },
      props: article,
    };
  });
}

const article = Astro.props;
---

<ArticleLayout article={article} />
